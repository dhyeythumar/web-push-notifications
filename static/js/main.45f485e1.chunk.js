(this["webpackJsonpweb-push-notifications"]=this["webpackJsonpweb-push-notifications"]||[]).push([[0],{14:function(e,t,r){},16:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var n=r(3),s=r.n(n),i=r(5),a=r.n(i),c=(r(14),r(0)),o=r.n(c),u=r(2),p=r(6),l=r(7),b=r(9),d=r(8),g=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(t),n=new Uint8Array(r.length),s=0;s<r.length;++s)n[s]=r.charCodeAt(s);return n},h=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={registered_SW:null,pushSubscriptionExists:!1,convertedVapidKey:null},"serviceWorker"in navigator){e.next=4;break}return alert("Service worker not present on navigator object!"),e.abrupt("return",t);case 4:return e.next=6,navigator.serviceWorker.register("/web-push-notifications/push-notification-SW.js",{scope:"/web-push-notifications/"});case 6:if(t.registered_SW=e.sent,console.log("Successfully registered service worker."),t.registered_SW.pushManager){e.next=13;break}return alert("Push Manager unavailable on service worker, so unregistering servive wroker!"),t.registered_SW.unregister(),t.registered_SW=null,e.abrupt("return",t);case 13:return e.next=15,t.registered_SW.pushManager.getSubscription();case 15:return null!==e.sent&&(alert("Existing subscription detected."),t.pushSubscriptionExists=!0),t.convertedVapidKey=g("BGBUgRmq_y5sm7NJdEJNQiho94QUv8VeUEJ57CXehZ7ybxKNFWAjHx2p_WgUz_sQB7XBGcEOLv2iJ5V3lMCWUtg"),e.abrupt("return",t);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:3000/api","/subscribe"),{method:"POST",body:JSON.stringify({subscription:t,ownerId:""}),headers:{"Content-Type":"application/json"}});case 3:if(r=e.sent,console.log(r),200!==r.status){e.next=7;break}return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),v=r.p+"static/media/logo.42627872.svg",S=(r(16),r(1)),x=function(e){Object(b.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(p.a)(this,r);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={registered_SW:null,pushSubscriptionExists:!1,convertedVapidKey:null},e.subscribeUser=Object(u.a)(o.a.mark((function t(){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.pushSubscriptionExists&&e.state.registered_SW){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,console.log("No subscription found, adding new subscription!"),t.next=6,e.state.registered_SW.pushManager.subscribe({applicationServerKey:e.state.convertedVapidKey,userVisibleOnly:!0});case 6:return r=t.sent,t.next=9,f(r);case 9:!0===t.sent&&e.setState({pushSubscriptionExists:!0}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),"granted"!==Notification.permission?alert("Notification permission was not granted!"):alert("Error ocurred while subscribing :: ",t.t0);case 16:case"end":return t.stop()}}),t,null,[[2,13]])}))),e.unRegisterSW=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.registered_SW&&(e.state.registered_SW.unregister(),console.log("Server worker successfully unregistered now you won't receive any new push notifications!"),e.setState({registered_SW:null,pushSubscriptionExists:!1}),alert("To register service worker again refresh the page."));case 1:case"end":return t.stop()}}),t)}))),e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:t=e.sent,this.setState({registered_SW:t.registered_SW,pushSubscriptionExists:t.pushSubscriptionExists,convertedVapidKey:t.convertedVapidKey});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsxs)("header",{className:"App-header",children:[Object(S.jsx)("img",{src:v,className:"App-logo",alt:"logo"}),Object(S.jsxs)("div",{className:"buttons",children:[Object(S.jsx)("button",{type:"button",onClick:this.subscribeUser,className:"subscribe-button",disabled:!(!this.state.pushSubscriptionExists&&this.state.registered_SW),children:"Subscribe to push notifications"}),Object(S.jsx)("button",{type:"button",onClick:this.unRegisterSW,className:"unregister-button",disabled:!this.state.registered_SW,children:"Unregister service worker"})]})]})})}}]),r}(n.Component),w=x,j=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,19)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,a=t.getTTFB;r(e),n(e),s(e),i(e),a(e)}))};a.a.render(Object(S.jsx)(s.a.StrictMode,{children:Object(S.jsx)(w,{})}),document.getElementById("root")),j()}},[[18,1,2]]]);
//# sourceMappingURL=main.45f485e1.chunk.js.map