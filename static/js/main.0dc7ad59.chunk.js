/*! For license information please see main.0dc7ad59.chunk.js.LICENSE.txt */
(this["webpackJsonpweb-push-notifications"]=this["webpackJsonpweb-push-notifications"]||[]).push([[0],{14:function(e,t,r){},16:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var n=r(3),s=r.n(n),i=r(5),a=r.n(i),c=(r(14),r(0)),o=r.n(c),u=r(2),b=r(6),l=r(7),p=r(9),d=r(8),f=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(t),n=new Uint8Array(r.length),s=0;s<r.length;++s)n[s]=r.charCodeAt(s);return n},g=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={registered_SW:null,existingSubscription:null,convertedVapidKey:f("")},e.next=3,navigator.serviceWorker.register("/web-push-notifications/push-notification-SW.js",{scope:"/web-push-notifications/"});case 3:if(t.registered_SW=e.sent,console.log("Successfully registered service worker."),t.registered_SW.pushManager){e.next=10;break}return alert("Push Manager unavailable on service worker, so unregistering servive wroker!"),t.registered_SW.unregister(),t.registered_SW=null,e.abrupt("return",t);case 10:return e.next=12,h(t.registered_SW);case 12:return t.existingSubscription=e.sent,e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:return null!==(r=e.sent)&&alert("Existing subscription detected."),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("","/subscribe"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t,ownerId:""})});case 3:return r=e.sent,e.next=6,r.json();case 6:if(n=e.sent,console.log(n),200!==r.status&&202!==r.status){e.next=10;break}return e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),x=r.p+"static/media/logo.42627872.svg",w=(r(16),r(1)),S=function(e){Object(p.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(b.a)(this,r);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={isNotificationAllowed:!1,registered_SW:null,subscription:null,convertedVapidKey:null},e.registerSW=Object(u.a)(o.a.mark((function t(){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.registered_SW){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,g();case 4:r=t.sent,e.setState({registered_SW:r.registered_SW,subscription:r.existingSubscription,convertedVapidKey:r.convertedVapidKey});case 6:case"end":return t.stop()}}),t)}))),e.unregisterSW=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.registered_SW){t.next=5;break}return t.next=3,e.state.registered_SW.unregister();case 3:e.setState({registered_SW:null,subscription:null}),console.log("Server worker successfully unregistered now you won't receive any new push notifications!");case 5:case"end":return t.stop()}}),t)}))),e.subscribeUser=Object(u.a)(o.a.mark((function t(){var r,n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.subscription&&e.state.registered_SW){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,h(e.state.registered_SW);case 4:if(!(r=t.sent)){t.next=7;break}return t.abrupt("return",e.setState({subscription:r}));case 7:return t.prev=7,console.log("No subscription found, adding new subscription!"),console.log("process.env.REACT_APP_PUBLIC_VAPID_KEY :: ",""),console.log("this.state.convertedVapidKey :: ",e.state.convertedVapidKey),console.log("process.env.REACT_APP_SERVER_URL :: ",""),console.log("process.env.REACT_APP_OWNER_ID :: ",""),t.next=15,e.state.registered_SW.pushManager.subscribe({applicationServerKey:e.state.convertedVapidKey,userVisibleOnly:!0});case 15:return n=t.sent,t.next=18,v(n);case 18:if(!0!==t.sent){t.next=23;break}e.setState({subscription:n}),t.next=25;break;case 23:return t.next=25,n.unsubscribe();case 25:t.next=30;break;case 27:t.prev=27,t.t0=t.catch(7),alert("[Error ocurred while subscribing] \n".concat(t.t0));case 30:case"end":return t.stop()}}),t,null,[[7,27]])}))),e.unsubscribeUser=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.subscription&&(e.state.subscription.unsubscribe(),e.setState({subscription:null}),console.log("Successfully unsubscribed now you won't receive any new push notifications!"));case 1:case"end":return t.stop()}}),t)}))),e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("showNotification"in ServiceWorkerRegistration.prototype){e.next=3;break}return alert("Notifications aren't supported!"),e.abrupt("return");case 3:if("serviceWorker"in navigator){e.next=6;break}return alert("ServiceWorker not present on navigator object!"),e.abrupt("return");case 6:if("PushManager"in window){e.next=9;break}return alert("Push messaging isn't supported!"),e.abrupt("return");case 9:if(console.log("Notification.permission :: ",Notification.permission),"default"!==Notification.permission){e.next=21;break}return e.next=13,Notification.requestPermission();case 13:if(t=e.sent,console.log(t),this.setState({isNotificationAllowed:"granted"===t||"default"===t}),"denied"!==t){e.next=19;break}return alert("Notification permission denied!"),e.abrupt("return");case 19:e.next=27;break;case 21:if("denied"!==Notification.permission){e.next=26;break}return alert("Notification permission denied!"),e.abrupt("return");case 26:this.setState({isNotificationAllowed:!0});case 27:return e.next=29,this.registerSW();case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"button-container",children:[Object(w.jsx)("button",{type:"button",onClick:this.registerSW,className:"register-button",disabled:!!this.state.registered_SW,children:"Register service worker"}),Object(w.jsx)("button",{type:"button",onClick:this.unregisterSW,className:"unregister-button",disabled:!this.state.registered_SW,children:"UnRegister service worker"})]}),Object(w.jsxs)("div",{className:"button-container",children:[Object(w.jsx)("button",{type:"button",onClick:this.subscribeUser,className:"subscribe-button",disabled:!(!this.state.subscription&&this.state.registered_SW),children:"Subscribe to push notifications"}),Object(w.jsx)("button",{type:"button",onClick:this.unsubscribeUser,className:"unsubscribe-button",disabled:!this.state.subscription,children:"UnSubscribe to push notifications"})]})]});return this.state.isNotificationAllowed||(e=Object(w.jsxs)("div",{className:"notification_not_allowed",children:["Notification is disabled for this website!",Object(w.jsx)("br",{}),"Allow the notifications & refresh the page."]})),Object(w.jsx)("div",{className:"App",children:Object(w.jsxs)("header",{className:"App-header",children:[Object(w.jsx)("img",{src:x,className:"App-logo",alt:"logo"}),e]})})}}]),r}(n.Component),j=S,k=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,19)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,a=t.getTTFB;r(e),n(e),s(e),i(e),a(e)}))};a.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)(j,{})}),document.getElementById("root")),k()}},[[18,1,2]]]);
//# sourceMappingURL=main.0dc7ad59.chunk.js.map