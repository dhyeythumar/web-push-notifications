(this["webpackJsonpweb-push-notifications"]=this["webpackJsonpweb-push-notifications"]||[]).push([[0],{14:function(e,t,r){},16:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var n=r(3),s=r.n(n),i=r(5),a=r.n(i),c=(r(14),r(0)),u=r.n(c),o=r(2),b=r(6),p=r(7),l=r(9),d=r(8),g=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(t),n=new Uint8Array(r.length),s=0;s<r.length;++s)n[s]=r.charCodeAt(s);return n},h=function(){var e=Object(o.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={registered_SW:null,existingSubscription:null,convertedVapidKey:g("BGBUgRmq_y5sm7NJdEJNQiho94QUv8VeUEJ57CXehZ7ybxKNFWAjHx2p_WgUz_sQB7XBGcEOLv2iJ5V3lMCWUtg")},"serviceWorker"in navigator){e.next=4;break}return alert("ServiceWorker not present on navigator object!"),e.abrupt("return",t);case 4:return e.next=6,navigator.serviceWorker.register("/web-push-notifications/push-notification-SW.js",{scope:"/web-push-notifications/"});case 6:if(t.registered_SW=e.sent,console.log("Successfully registered service worker."),t.registered_SW.pushManager){e.next=13;break}return alert("Push Manager unavailable on service worker, so unregistering servive wroker!"),t.registered_SW.unregister(),t.registered_SW=null,e.abrupt("return",t);case 13:return e.next=15,f(t.registered_SW);case 15:return t.existingSubscription=e.sent,e.abrupt("return",t);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(o.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:return null!==(r=e.sent)&&alert("Existing subscription detected."),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(o.a)(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://localhost:3000/api","/subscribe"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:t,ownerId:"61b4434b29bc2dc349ea4293"})});case 3:return r=e.sent,e.next=6,r.json();case 6:if(n=e.sent,console.log(n),200!==r.status){e.next=10;break}return e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),x=r.p+"static/media/logo.42627872.svg",S=(r(16),r(1)),w=function(e){Object(l.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(b.a)(this,r);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={registered_SW:null,subscription:null,convertedVapidKey:null},e.registerSW=Object(o.a)(u.a.mark((function t(){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.registered_SW){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,h();case 4:r=t.sent,e.setState({registered_SW:r.registered_SW,subscription:r.existingSubscription,convertedVapidKey:r.convertedVapidKey});case 6:case"end":return t.stop()}}),t)}))),e.unregisterSW=Object(o.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.registered_SW){t.next=5;break}return t.next=3,e.state.registered_SW.unregister();case 3:e.setState({registered_SW:null,subscription:null}),console.log("Server worker successfully unregistered now you won't receive any new push notifications!");case 5:case"end":return t.stop()}}),t)}))),e.subscribeUser=Object(o.a)(u.a.mark((function t(){var r,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.subscription&&e.state.registered_SW){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,f(e.state.registered_SW);case 4:if(!(r=t.sent)){t.next=7;break}return t.abrupt("return",e.setState({subscription:r}));case 7:return t.prev=7,console.log("No subscription found, adding new subscription!"),t.next=11,e.state.registered_SW.pushManager.subscribe({applicationServerKey:e.state.convertedVapidKey,userVisibleOnly:!0});case 11:return n=t.sent,t.next=14,v(n);case 14:if(!0!==t.sent){t.next=19;break}e.setState({subscription:n}),t.next=21;break;case 19:return t.next=21,n.unsubscribe();case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(7),"granted"!==Notification.permission?alert("Notification permission was not granted!"):alert("Error ocurred while subscribing :: ",t.t0);case 26:case"end":return t.stop()}}),t,null,[[7,23]])}))),e.unsubscribeUser=Object(o.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state.subscription&&(e.state.subscription.unsubscribe(),e.setState({subscription:null}),console.log("Successfully unsubscribed now you won't receive any new push notifications!"));case 1:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(r,[{key:"componentDidMount",value:function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registerSW();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsxs)("header",{className:"App-header",children:[Object(S.jsx)("img",{src:x,className:"App-logo",alt:"logo"}),Object(S.jsxs)("div",{className:"buttons",children:[Object(S.jsxs)("div",{className:"button-container",children:[Object(S.jsx)("button",{type:"button",onClick:this.registerSW,className:"register-button",disabled:!!this.state.registered_SW,children:"Register service worker"}),Object(S.jsx)("button",{type:"button",onClick:this.unregisterSW,className:"unregister-button",disabled:!this.state.registered_SW,children:"UnRegister service worker"})]}),Object(S.jsxs)("div",{className:"button-container",children:[Object(S.jsx)("button",{type:"button",onClick:this.subscribeUser,className:"subscribe-button",disabled:!(!this.state.subscription&&this.state.registered_SW),children:"Subscribe to push notifications"}),Object(S.jsx)("button",{type:"button",onClick:this.unsubscribeUser,className:"unsubscribe-button",disabled:!this.state.subscription,children:"UnSubscribe to push notifications"})]})]})]})})}}]),r}(n.Component),j=w,k=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,19)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,a=t.getTTFB;r(e),n(e),s(e),i(e),a(e)}))};a.a.render(Object(S.jsx)(s.a.StrictMode,{children:Object(S.jsx)(j,{})}),document.getElementById("root")),k()}},[[18,1,2]]]);
//# sourceMappingURL=main.bd0e7184.chunk.js.map